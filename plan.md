# План миграции сайта 'wow' на Laravel

## Анализ текущей структуры

### Текущая архитектура:
- **Язык**: PHP (нативный)
- **Базы данных**: MySQL (auth, world, char, site)
- **Маршрутизация**: .htaccess → pages/
- **Аутентификация**: Сессии + кастомные классы
- **Многоязычность**: Файлы в languages/
- **Админка**: Кастомная система
- **Ассеты**: CSS/JS с минификацией

### Ключевые компоненты для миграции:
- Класс Database (PDO wrapper)
- Класс News (новости)
- Класс User (пользователи)
- Многоязычная система
- Система сессий
- Админ-панель
- Магазин предметов

## Поэтапный план миграции

### Этап 1: Настройка окружения
- [ ] Установка Laravel в директорию site/
- [ ] Настройка .env для тестового хоста site.loc
- [ ] Конфигурация баз данных (auth, world, char, site)
- [ ] Перенос статических ассетов (img/, assets/)

### Этап 2: Главная страница
- [ ] Создание контроллера HomeController
- [ ] Миграция home.php в Blade шаблон
- [ ] Интеграция слайдера и Discord виджета
- [ ] Перенос системы новостей (News класс → Eloquent Model)

### Этап 3: Система аутентификации
- [ ] Миграция кастомной аутентификации на Laravel Auth
- [ ] Перенос классов User, Registration, Session
- [ ] Настройка middleware для защиты роутов
- [ ] Интеграция с auth базой данных

### Этап 4: Многоязычность
- [ ] Перенос языковых файлов в resources/lang/
- [ ] Создание Language middleware
- [ ] Интеграция переключателя языков
- [ ] Обновление всех Blade шаблонов

### Этап 5: Пользовательские страницы
- [ ] Account (личный кабинет)
- [ ] Shop (магазин)
- [ ] News (новости)
- [ ] Armory (армори)
- [ ] How to Play (инструкции)

### Этап 6: Админ-панель
- [ ] Миграция админских контроллеров
- [ ] Настройка прав доступа (роли admin/moderator)
- [ ] Управление новостями, пользователями, предметами
- [ ] GM команды и управление сервером

### Этап 7: Безопасность и оптимизация
- [ ] Настройка CSRF защиты
- [ ] Валидация данных
- [ ] Миграция asset minification в Laravel Mix
- [ ] Кэширование и производительность

### Этап 8: Тестирование и деплой
- [ ] Поэтапное тестирование каждого компонента
- [ ] Настройка на тестовом хосте site.loc
- [ ] Финальное тестирование всей системы
- [ ] Деплой на продакшен

## Технические детали

### Базы данных:
- **auth**: Аутентификация пользователей
- **world**: Игровые данные
- **char**: Данные персонажей
- **site**: Данные сайта (новости, магазин)

### Безопасность:
- Использование Laravel встроенной аутентификации
- Middleware для проверки прав доступа
- Валидация всех входящих данных
- Защита от SQL инъекций через Eloquent

### Производительность:
- Кэширование запросов к базе данных
- Минификация ассетов через Laravel Mix
- Оптимизация изображений
- Использование CDN для статических файлов

## График выполнения

1. **Неделя 1**: Этапы 1-2 (Окружение + Главная страница)
2. **Неделя 2**: Этапы 3-4 (Аутентификация + Многоязычность)
3. **Неделя 3**: Этапы 5-6 (Пользовательские страницы + Админка)
4. **Неделя 4**: Этапы 7-8 (Безопасность + Тестирование)

Каждый этап включает тестирование на тестовом хосте site.loc перед переходом к следующему.